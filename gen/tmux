#!/bin/sh

# Note: this directory is used internally be tic
mkdir -p $HOME/.terminfo

# cat > /tmp/terminfo.src <<EOF
# tmux-256color|tmux running on top of rxvt-unicode-256color,
#   use=screen-256color,
#   sitm=\E[3m,ritm=\E[23m,smso=\E[7m,rmso=\E[27m,

# alacritty|alacritty terminal emulator,
#   use=xterm-256color,
#   tc,
#   setb24=\E[48;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
#   setf24=\E[38;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,

# tmux-alacritty|tmux running on top of alacritty,
#   use=screen-256color,
#   tc,
#   setb24=\E[48;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
#   setf24=\E[38;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
# EOF

# tic -x /tmp/terminfo.src
# exit

function term {
  cat > /tmp/$1.terminfo
  tic -o $HOME/.terminfo -x /tmp/$1.terminfo
}

term tmux-256color <<EOF
tmux-256color|tmux running on top of rxvt-unicode-256color,
  use=screen-256color,
  sitm=\E[3m,ritm=\E[23m,s,smso=\E[7m,rmso=\E[27m,
EOF

# True color:
#  (emacs) http://git.savannah.gnu.org/cgit/emacs.git/commit/?id=e463e57
#  (tmux)  http://lists.schmorp.de/pipermail/rxvt-unicode/2016q2/002251.html

term alacritty <<EOF
alacritty|alacritty terminal emulator,
  use=xterm-256color,
  tc,
  setb24=\E[48;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
  setf24=\E[38;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
EOF

term tmux-alacritty <<EOF
alacritty|tmux running on top of alacritty,
  use=screen-256color,
  tc,
  setb24=\E[48;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
  setf24=\E[38;2;%p1%@{65536@}%/%d;%p1%@{256@}%/%@{255@}%&%d;%p1%@{255@}%&%dm,
EOF

# file=/tmp/tmux-256color.terminfo

# infocmp screen-256color | sed \
#     -e 's/^screen[^,]*,/tmux-256color|tmux running on top of rxvt-unicode-256color,/' \
#     -e 's/smso/sitm/' -e 's/rmso/ritm/' > $file
# cat >> $file <<EOF
#         smso=\E[7m,rmso=\E[27m,
# EOF

# ## Extra lines we might want...?
# #	kDC=\E[3$, kEND=\E[8$, kHOM=\E[7$, kIC=\E[2$, kLFT=\E[d,
# #	kNXT=\E[6$, kPRV=\E[5$, kRIT=\E[c,

# tic $file


# file=/tmp/alacritty.terminfo

# infocmp xterm-256color | sed \
#     -e 's/^xterm[^,]*,/alacritty|alacritty,/' \
#     -e 's/smso/sitm/' -e 's/rmso/ritm/' > $file
# cat >> $file <<EOF
#         smso=\E[7m,rmso=\E[27m,
#         tc,
#         setb
# EOF

# ## Extra lines we might want...?
# #	kDC=\E[3$, kEND=\E[8$, kHOM=\E[7$, kIC=\E[2$, kLFT=\E[d,
# #	kNXT=\E[6$, kPRV=\E[5$, kRIT=\E[c,

# tic $file
